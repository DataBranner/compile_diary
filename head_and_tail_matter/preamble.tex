%!TEX TS-program = xelatex
%!TEX encoding = UTF-8 Unicode

% THIS TEMPLATE IS DATED 20161121

\documentclass[11pt,asymmetric]{article}
\usepackage[tmargin=1in, bmargin=1in, lmargin=0.5in, rmargin=0.5in]{geometry}
\geometry{letterpaper}
\usepackage[final]{graphicx}
\usepackage{amsmath}
\usepackage{mathspec}			% replaces amssymb; do not use unicode-math; warning: conflicts with package scrextend, so now using footmisc. Also, conflicts with use of upquote in listings; hence (20131107) using verbatim where backtick requires use of upquote.
\usepackage{url}
\usepackage{datetime}			% allows \currenttime
\usepackage{ulem}
\usepackage{multicol}
\usepackage{upquote}			% preserves backticks in verbatim environments
\usepackage{rotating}			% allows sidewaystable environment
\usepackage{dpfloat}			% allows use of leftfullpage and fullpage environments, to place successive figures on facing pages
\usepackage{caption}			% allows use of \captions*
\usepackage{xcolor}

\usepackage[hang]{footmisc}

\usepackage{alltt}			% allows good verbatim text
\usepackage{textcomp}			% required for listings with upquote
\usepackage{listings}			% allows good verbatim text for code (only)
\lstset{upquote=true,breaklines=true}

%%%%%%%%%%%%%%%%%%%%%%%
% Languages and fonts %
%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[fallback]{xeCJK}[2011/05/01 v2.3.19]
\usepackage{fontspec}
\defaultfontfeatures{Mapping=tex-text}
\setromanfont{TeX Gyre Termes}
\setsansfont[Scale=MatchLowercase]{Doulos SIL}
\setCJKmainfont{HAN NOM A}
\setCJKfallbackfamilyfont{\CJKrmdefault}{HAN NOM B}	% goes with Han Nom A

\setCJKfamilyfont{korm}{Arial Unicode MS}
\newcommand\Korean{\renewcommand\CJKrmdefault{korm}\CJKspace\normalfont}

\newfontfamily\fontUTF{Arial Unicode MS}
\newfontfamily\fontTNR{Times New Roman}

\newfontfamily\greekfont[Scale=MatchUppercase,Ligatures=TeX]{Arial Unicode MS}

\newcommand{\textgreek}[1]
    {\bgroup\greekfont{#1}\egroup} % Greek text

\newenvironment{greekpar}           % Greek paragraph
    {\greekfont}{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% End, languages and fonts %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\graphicspath{{./diary_graphics/}}
\DeclareGraphicsExtensions{.jpg,.jpeg,.png}
\usepackage{calc}
\newlength{\imgwidth}
\newcommand\grw[1]{%   
    \settowidth{\imgwidth}{\includegraphics{#1}}%
    \setlength{\imgwidth}{\minof{\imgwidth}{\textwidth}}%
    \includegraphics[width=\imgwidth]{#1}%
}
\newlength{\imgheight}
\newcommand\grh[1]{%   
    \settoheight{\imgheight}{\includegraphics{#1}}%
    \setlength{\imgheight}{\minof{\imgheight}{\textheight}}%
    \includegraphics[height=\imgheight]{#1}%
}

\newcommand*{\inputpath}{sections/}

\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhead{}
\fancyfoot{}
\fancyhead[RO]{\textbf\leftmark}
\fancyhead[LE]{\textbf\rightmark}
\fancyhead[RE,LO]{\footnotesize{printed at \currenttime, \today}}
\fancyfoot[C]{\thepage}
\headheight14.5pt		% this value chosen in response to warning messages

% ggg remove this soon
\usepackage{newunicodechar}
\newfontfamily\pmingliu{PMingLiU}
\newunicodechar{○}{{\pmingliu ○}}


% define section, subsection, subsubsection for TOC
\newcommand\sect[1]{%
 \section*{#1}\markboth{#1}{#1}\addcontentsline{toc}{section}{#1}}

%%%%%%%%%%%%%%%%%%%%
%%%  TOC START   %%%
%%%%%%%%%%%%%%%%%%%%

\usepackage{titletoc}
\titlecontents{section}[2em]  % absolute left margin of TOC
{\addvspace{-1.0em}\footnotesize} % vertical distance between entries and format of entries
{\contentslabel{2.7em}} % distance between left column edge and start of TOC entry
{\hspace*{-2em}}
{\titlerule*[0.3pc]{.}\contentspage} % symbol for ``rule'' and distance between

\titlecontents{subsection}[2.1em]
{\addvspace{-1.0em}\footnotesize}
{\contentslabel{.8em}} % with numbering
{\hspace*{-.8em}} % with numbering
{\titlerule*[0.3pc]{.}\contentspage}

\titlecontents{subsubsection}[2.2em]
{\addvspace{-1.0em}\footnotesize}
{\contentslabel{.9em}} % with numbering
{\hspace*{-1em}} % with numbering
{\titlerule*[0.3pc]{.}\contentspage}

% ----- Redefinition of \section -----
\makeatletter
\renewcommand\section{\@startsection{section}{1}{0pt}%
                 {-3.5ex plus -1ex minus -.2ex}%
                 {2.3ex plus.2ex}%
                 {\normalfont\Large\bfseries}}
\makeatother


% ----- Redefinition of \subsection -----
\makeatletter
\renewcommand\subsection{\@startsection{subsection}{1}{0pt}%
                 {-3.5ex plus -1ex minus -.2ex}%
                 {2.3ex plus.2ex}%
                 {\normalfont\Large\bfseries}}
\makeatother


% ----- Redefinition of \subsubsection -----
\makeatletter
\renewcommand\subsubsection{\@startsection{subsubsection}{1}{0pt}%
                 {-3.5ex plus -1ex minus -.2ex}%
                 {2.3ex plus.2ex}%
                 {\normalfont\Large\bfseries}}
\makeatother
% ----------------------

\renewcommand{\thesubsection}{•}
\renewcommand{\thesubsubsection}{\Alph{subsubsection}}

\usepackage{hyperref}            % adds clickable links to TOC
\hypersetup{
    colorlinks=true,
    linkcolor=gray,
    urlcolor=gray,
}

%%%%%%%%%%%%%%%%%%%%
%%%  TOC  END   %%%
%%%%%%%%%%%%%%%%%%%%


\widowpenalty=10000			% avoid widows
\clubpenalty=10000			% avoid orphans

\frenchspacing
\raggedright

\parskip9pt


%%%%%%%%%%%%%%%%%%%%%%
% start dpb's macros %
%%%%%%%%%%%%%%%%%%%%%%

% Include graphics, scaled.
\newcommand\gr[2]{\scalebox{#2}{\includegraphics{#1}}}

% Identify IPA as such
\newcommand \IPA[1]{\textsf{#1}}

% Set format of POS markers.
\newcommand{\POS}[1]{\textbf{\textsf{#1}}}
\newcommand{\POSsub}[1]{\(_{\mathbf{\mathsf{#1}}}\)}

% Line across the page
\newcommand{\lineacross}[1]{\vskip12pt\hrule\vskip12pt}

% Ellipsis with non-breaking spaces on both sides
\newcommand{\ellipsis}[1]{\nolinebreak\(~\ldots~\)\nolinebreak}

% for raising letter e and other things
\newcommand\raised[1]{\(^{\text{\footnotesize{#1}}}\)}

%%%%%%%%%%%%%%%%%%%%
% end dpb's macros %
%%%%%%%%%%%%%%%%%%%%

\title{Diary}
\author{(Author's name here)}

\begin{document}

\maketitle

\pagenumbering{roman}

\begin{multicols}{3}
\setlength\columnseprule{.2pt}
\tableofcontents
\end{multicols}



\pagestyle{fancy}
\fancyhead{}
\fancyfoot{}
\fancyhead[RO]{\textbf\leftmark}
\fancyhead[LE]{\textbf\rightmark}
\fancyhead[RE,LO]{\footnotesize{printed at \currenttime, \today}}
\fancyfoot[C]{\thepage}
\headheight14.5pt		% this value chosen in response to warning messages
\pagenumbering{arabic}

\hrule

